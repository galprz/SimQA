hello from Python 3.7.11 in /home/nitai/miniconda3/envs/SimQA-code/bin/python
running train_mle.py experiments
2021-09-15 08:14:36,634 INFO Running on device=`cuda` (device_id=0)
2021-09-15 08:14:52,707 INFO Start training loop and validate every 100 steps...
2021-09-15 08:14:52,708 INFO Loading dataset from data/v1/processed/SimQA.valid.0.pt
2021-09-15 08:14:52,752 INFO number of examples: 555
2021-09-15 08:15:17,288 INFO Validation metrics: Bleu: 0.9970,Correct answers 0.8516, State transitions score: 0.8825
2021-09-15 08:15:17,290 INFO Loading dataset from data/v1/processed/SimQA.train.0.pt
2021-09-15 08:15:17,362 INFO number of examples: 3148
/home/nitai/miniconda3/envs/SimQA-code/lib/python3.7/site-packages/onmt/translate/beam_search.py:209: UserWarning: An output with one or more elements was resized since it had shape [512], which does not match the required output shape [16, 32].This behavior is deprecated, and in a future PyTorch release outputs will not be resized unless they have zero elements. You can explicitly reuse an out tensor t by resizing it, inplace, to zero elements with t.resize_(0). (Triggered internally at  /pytorch/aten/src/ATen/native/Resize.cpp:23.)
  torch.mul(self.topk_scores, length_penalty, out=self.topk_log_probs)
/home/nitai/miniconda3/envs/SimQA-code/lib/python3.7/site-packages/torch/_tensor.py:575: UserWarning: floor_divide is deprecated, and will be removed in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values.
To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor'). (Triggered internally at  /pytorch/aten/src/ATen/native/BinaryOps.cpp:467.)
  return torch.floor_divide(self, other)
2021-09-15 08:15:42,387 INFO Training step 2
2021-09-15 08:16:09,393 INFO Training step 4
2021-09-15 08:16:34,766 INFO Training step 6
2021-09-15 08:17:01,114 INFO Training step 8
2021-09-15 08:17:26,632 INFO Training step 10
2021-09-15 08:17:51,954 INFO Training step 12
2021-09-15 08:18:18,486 INFO Training step 14
2021-09-15 08:18:43,637 INFO Training step 16
2021-09-15 08:19:06,530 INFO Training step 18
2021-09-15 08:19:23,940 INFO Training step 20
2021-09-15 08:19:41,094 INFO Training step 22
2021-09-15 08:20:07,319 INFO Training step 24
2021-09-15 08:20:28,915 INFO Training step 26
2021-09-15 08:20:50,849 INFO Training step 28
2021-09-15 08:21:11,303 INFO Training step 30
2021-09-15 08:21:26,945 INFO Training step 32
/home/nitai/miniconda3/envs/SimQA-code/lib/python3.7/site-packages/onmt/translate/beam_search.py:209: UserWarning: An output with one or more elements was resized since it had shape [384], which does not match the required output shape [12, 32].This behavior is deprecated, and in a future PyTorch release outputs will not be resized unless they have zero elements. You can explicitly reuse an out tensor t by resizing it, inplace, to zero elements with t.resize_(0). (Triggered internally at  /pytorch/aten/src/ATen/native/Resize.cpp:23.)
  torch.mul(self.topk_scores, length_penalty, out=self.topk_log_probs)
2021-09-15 08:21:44,557 INFO Training step 34
2021-09-15 08:22:02,601 INFO Training step 36
2021-09-15 08:22:20,284 INFO Training step 38
2021-09-15 08:22:37,653 INFO Training step 40
2021-09-15 08:22:55,062 INFO Training step 42
2021-09-15 08:23:12,853 INFO Training step 44
2021-09-15 08:23:30,121 INFO Training step 46
2021-09-15 08:23:47,198 INFO Training step 48
2021-09-15 08:24:04,354 INFO Training step 50
2021-09-15 08:24:22,477 INFO Training step 52
2021-09-15 08:24:40,416 INFO Training step 54
2021-09-15 08:24:57,597 INFO Training step 56
2021-09-15 08:25:15,515 INFO Training step 58
2021-09-15 08:25:33,139 INFO Training step 60
2021-09-15 08:25:50,396 INFO Training step 62
2021-09-15 08:26:07,250 INFO Training step 64
2021-09-15 08:26:23,671 INFO Training step 66
2021-09-15 08:26:39,577 INFO Training step 68
2021-09-15 08:26:57,234 INFO Training step 70
2021-09-15 08:27:13,649 INFO Training step 72
2021-09-15 08:27:30,189 INFO Training step 74
2021-09-15 08:27:45,573 INFO Training step 76
2021-09-15 08:28:01,741 INFO Training step 78
2021-09-15 08:28:19,714 INFO Training step 80
2021-09-15 08:28:37,205 INFO Training step 82
2021-09-15 08:28:54,404 INFO Training step 84
2021-09-15 08:29:11,379 INFO Training step 86
2021-09-15 08:29:24,003 INFO Loading dataset from data/v1/processed/SimQA.train.0.pt
2021-09-15 08:29:24,081 INFO number of examples: 3148
2021-09-15 08:29:28,890 INFO Training step 88
2021-09-15 08:29:46,568 INFO Training step 90
2021-09-15 08:30:02,787 INFO Training step 92
2021-09-15 08:30:19,509 INFO Training step 94
2021-09-15 08:30:36,785 INFO Training step 96
2021-09-15 08:30:53,176 INFO Training step 98
2021-09-15 08:31:11,248 INFO Training step 100
2021-09-15 08:31:11,250 INFO Loading dataset from data/v1/processed/SimQA.valid.0.pt
2021-09-15 08:31:11,263 INFO number of examples: 555
2021-09-15 08:31:35,394 INFO Validation metrics: Bleu: 0.9971,Correct answers 0.8620, State transitions score: 0.8494
2021-09-15 08:31:53,017 INFO Training step 102
2021-09-15 08:32:10,680 INFO Training step 104
2021-09-15 08:32:27,714 INFO Training step 106
2021-09-15 08:32:45,083 INFO Training step 108
2021-09-15 08:33:01,902 INFO Training step 110
2021-09-15 08:33:15,202 INFO Training step 112
2021-09-15 08:33:32,563 INFO Training step 114
2021-09-15 08:33:50,094 INFO Training step 116
2021-09-15 08:34:06,950 INFO Training step 118
2021-09-15 08:34:20,520 INFO Training step 120
2021-09-15 08:34:33,948 INFO Training step 122
2021-09-15 08:34:45,663 INFO Training step 124
2021-09-15 08:34:59,117 INFO Training step 126
2021-09-15 08:35:12,414 INFO Training step 128
2021-09-15 08:35:28,973 INFO Training step 130
2021-09-15 08:35:45,295 INFO Training step 132
2021-09-15 08:35:58,136 INFO Training step 134
2021-09-15 08:36:12,129 INFO Training step 136
2021-09-15 08:36:28,921 INFO Training step 138
2021-09-15 08:36:47,275 INFO Training step 140
2021-09-15 08:37:00,150 INFO Training step 142
2021-09-15 08:37:13,687 INFO Training step 144
2021-09-15 08:37:30,126 INFO Training step 146
2021-09-15 08:37:47,395 INFO Training step 148
2021-09-15 08:38:04,003 INFO Training step 150
2021-09-15 08:38:21,077 INFO Training step 152
2021-09-15 08:38:34,065 INFO Training step 154
2021-09-15 08:38:50,630 INFO Training step 156
2021-09-15 08:39:03,603 INFO Training step 158
2021-09-15 08:39:16,746 INFO Training step 160
2021-09-15 08:39:33,229 INFO Training step 162
2021-09-15 08:39:46,572 INFO Training step 164
2021-09-15 08:40:00,369 INFO Training step 166
2021-09-15 08:40:16,729 INFO Training step 168
2021-09-15 08:40:29,581 INFO Training step 170
2021-09-15 08:40:46,375 INFO Training step 172
2021-09-15 08:40:58,564 INFO Training step 174
2021-09-15 08:41:15,525 INFO Training step 176
2021-09-15 08:41:29,256 INFO Training step 178
2021-09-15 08:41:45,812 INFO Training step 180
2021-09-15 08:41:58,882 INFO Training step 182
2021-09-15 08:42:16,198 INFO Training step 184
2021-09-15 08:42:29,471 INFO Training step 186
2021-09-15 08:42:45,691 INFO Training step 188
2021-09-15 08:43:03,231 INFO Training step 190
2021-09-15 08:43:16,713 INFO Training step 192
2021-09-15 08:43:33,503 INFO Training step 194
2021-09-15 08:43:49,522 INFO Training step 196
2021-09-15 08:43:53,952 INFO Loading dataset from data/v1/processed/SimQA.train.0.pt
2021-09-15 08:43:54,026 INFO number of examples: 3148
2021-09-15 08:43:58,368 INFO Training step 198
2021-09-15 08:44:14,910 INFO Training step 200
2021-09-15 08:44:14,912 INFO Loading dataset from data/v1/processed/SimQA.valid.0.pt
2021-09-15 08:44:14,924 INFO number of examples: 555
2021-09-15 08:44:39,031 INFO Validation metrics: Bleu: 0.9975,Correct answers 0.8698, State transitions score: 0.8802
2021-09-15 08:44:52,638 INFO Training step 202
2021-09-15 08:45:06,168 INFO Training step 204
2021-09-15 08:45:22,853 INFO Training step 206
2021-09-15 08:45:40,513 INFO Training step 208
2021-09-15 08:45:48,990 INFO Training step 210
2021-09-15 08:46:05,191 INFO Training step 212
2021-09-15 08:46:21,903 INFO Training step 214
2021-09-15 08:46:34,193 INFO Training step 216
2021-09-15 08:46:51,539 INFO Training step 218
2021-09-15 08:47:00,945 INFO Training step 220
2021-09-15 08:47:16,985 INFO Training step 222
2021-09-15 08:47:26,121 INFO Training step 224
2021-09-15 08:47:39,224 INFO Training step 226
2021-09-15 08:47:48,570 INFO Training step 228
2021-09-15 08:48:01,612 INFO Training step 230
2021-09-15 08:48:18,797 INFO Training step 232
2021-09-15 08:48:32,418 INFO Training step 234
2021-09-15 08:48:45,132 INFO Training step 236
2021-09-15 08:49:01,370 INFO Training step 238
2021-09-15 08:49:13,497 INFO Training step 240
2021-09-15 08:49:30,812 INFO Training step 242
2021-09-15 08:49:39,903 INFO Training step 244
2021-09-15 08:49:52,952 INFO Training step 246
2021-09-15 08:50:06,404 INFO Training step 248
2021-09-15 08:50:19,265 INFO Training step 250
2021-09-15 08:50:31,625 INFO Training step 252
2021-09-15 08:50:44,249 INFO Training step 254
2021-09-15 08:50:57,036 INFO Training step 256
2021-09-15 08:51:14,365 INFO Training step 258
2021-09-15 08:51:26,841 INFO Training step 260
2021-09-15 08:51:42,435 INFO Training step 262
2021-09-15 08:51:58,725 INFO Training step 264
2021-09-15 08:52:07,867 INFO Training step 266
2021-09-15 08:52:21,035 INFO Training step 268
2021-09-15 08:52:38,261 INFO Training step 270
2021-09-15 08:52:55,102 INFO Training step 272
2021-09-15 08:53:04,323 INFO Training step 274
2021-09-15 08:53:17,652 INFO Training step 276
2021-09-15 08:53:31,503 INFO Training step 278
2021-09-15 08:53:40,935 INFO Training step 280
2021-09-15 08:53:53,691 INFO Training step 282
2021-09-15 08:54:03,621 INFO Training step 284
2021-09-15 08:54:21,440 INFO Training step 286
2021-09-15 08:54:34,977 INFO Training step 288
2021-09-15 08:54:44,824 INFO Training step 290
2021-09-15 08:54:58,412 INFO Training step 292
2021-09-15 08:55:16,506 INFO Training step 294
2021-09-15 08:55:34,545 INFO Training step 296
2021-09-15 08:55:48,734 INFO Training step 298
2021-09-15 08:56:03,309 INFO Training step 300
2021-09-15 08:56:03,311 INFO Loading dataset from data/v1/processed/SimQA.valid.0.pt
2021-09-15 08:56:03,324 INFO number of examples: 555
2021-09-15 08:56:29,457 INFO Validation metrics: Bleu: 0.9121,Correct answers 0.8265, State transitions score: 0.8115
2021-09-15 08:56:43,025 INFO Training step 302
2021-09-15 08:56:56,836 INFO Training step 304
2021-09-15 08:57:15,783 INFO Training step 306
2021-09-15 08:57:33,960 INFO Training step 308
2021-09-15 08:57:52,413 INFO Training step 310
2021-09-15 08:58:11,180 INFO Training step 312
2021-09-15 08:58:28,827 INFO Training step 314
2021-09-15 08:58:46,385 INFO Training step 316
2021-09-15 08:59:00,363 INFO Training step 318
2021-09-15 08:59:09,698 INFO Loading dataset from data/v1/processed/SimQA.train.0.pt
2021-09-15 08:59:09,767 INFO number of examples: 3148
2021-09-15 08:59:14,363 INFO Training step 320
2021-09-15 08:59:27,227 INFO Training step 322
2021-09-15 08:59:45,175 INFO Training step 324
2021-09-15 08:59:59,355 INFO Training step 326
2021-09-15 09:00:12,218 INFO Training step 328
2021-09-15 09:00:31,483 INFO Training step 330
2021-09-15 09:00:49,066 INFO Training step 332
2021-09-15 09:01:03,089 INFO Training step 334
2021-09-15 09:01:21,970 INFO Training step 336
2021-09-15 09:01:39,975 INFO Training step 338
2021-09-15 09:01:53,433 INFO Training step 340
2021-09-15 09:02:11,219 INFO Training step 342
2021-09-15 09:02:29,569 INFO Training step 344
2021-09-15 09:02:43,776 INFO Training step 346
2021-09-15 09:02:57,849 INFO Training step 348
2021-09-15 09:03:12,338 INFO Training step 350
2021-09-15 09:03:30,439 INFO Training step 352
2021-09-15 09:03:44,778 INFO Training step 354
2021-09-15 09:04:03,193 INFO Training step 356
2021-09-15 09:04:21,881 INFO Training step 358
2021-09-15 09:04:40,322 INFO Training step 360
2021-09-15 09:04:54,152 INFO Training step 362
2021-09-15 09:05:11,853 INFO Training step 364
2021-09-15 09:05:26,182 INFO Training step 366
2021-09-15 09:05:44,370 INFO Training step 368
2021-09-15 09:06:02,788 INFO Training step 370
2021-09-15 09:06:18,035 INFO Training step 372
2021-09-15 09:06:28,139 INFO Training step 374
2021-09-15 09:06:42,638 INFO Training step 376
2021-09-15 09:07:02,062 INFO Training step 378
2021-09-15 09:07:15,674 INFO Training step 380
2021-09-15 09:07:29,401 INFO Training step 382
2021-09-15 09:07:47,633 INFO Training step 384
2021-09-15 09:07:57,013 INFO Training step 386
2021-09-15 09:08:15,005 INFO Training step 388
2021-09-15 09:08:25,135 INFO Training step 390
2021-09-15 09:08:38,894 INFO Training step 392
2021-09-15 09:08:52,810 INFO Training step 394
2021-09-15 09:09:06,962 INFO Training step 396
2021-09-15 09:09:20,368 INFO Training step 398
2021-09-15 09:09:38,586 INFO Training step 400
2021-09-15 09:09:38,588 INFO Loading dataset from data/v1/processed/SimQA.valid.0.pt
2021-09-15 09:09:38,600 INFO number of examples: 555
2021-09-15 09:10:04,588 INFO Validation metrics: Bleu: 0.9468,Correct answers 0.8655, State transitions score: 0.8681
2021-09-15 09:10:22,549 INFO Training step 402
2021-09-15 09:10:32,586 INFO Training step 404
2021-09-15 09:10:46,372 INFO Training step 406
2021-09-15 09:10:59,900 INFO Training step 408
2021-09-15 09:11:17,808 INFO Training step 410
2021-09-15 09:11:31,852 INFO Training step 412
2021-09-15 09:11:45,994 INFO Training step 414
2021-09-15 09:12:05,077 INFO Training step 416
2021-09-15 09:12:19,412 INFO Training step 418
2021-09-15 09:12:33,495 INFO Training step 420
2021-09-15 09:12:51,853 INFO Training step 422
2021-09-15 09:13:11,012 INFO Training step 424
2021-09-15 09:13:29,461 INFO Training step 426
2021-09-15 09:13:48,426 INFO Training step 428
2021-09-15 09:14:06,170 INFO Training step 430
2021-09-15 09:14:19,158 INFO Training step 432
2021-09-15 09:14:38,220 INFO Training step 434
2021-09-15 09:14:47,607 INFO Loading dataset from data/v1/processed/SimQA.train.0.pt
2021-09-15 09:14:47,680 INFO number of examples: 3148
2021-09-15 09:14:52,573 INFO Training step 436
2021-09-15 09:15:07,391 INFO Training step 438
2021-09-15 09:15:25,079 INFO Training step 440
2021-09-15 09:15:44,547 INFO Training step 442
2021-09-15 09:16:03,228 INFO Training step 444
2021-09-15 09:16:21,176 INFO Training step 446
2021-09-15 09:16:34,705 INFO Training step 448
2021-09-15 09:16:48,888 INFO Training step 450
2021-09-15 09:17:06,950 INFO Training step 452
2021-09-15 09:17:23,950 INFO Training step 454
2021-09-15 09:17:41,361 INFO Training step 456
2021-09-15 09:17:51,089 INFO Training step 458
2021-09-15 09:18:04,419 INFO Training step 460
2021-09-15 09:18:14,176 INFO Training step 462
2021-09-15 09:18:27,413 INFO Training step 464
2021-09-15 09:18:40,748 INFO Training step 466
2021-09-15 09:18:54,524 INFO Training step 468
2021-09-15 09:19:12,143 INFO Training step 470
2021-09-15 09:19:21,516 INFO Training step 472
2021-09-15 09:19:35,536 INFO Training step 474
2021-09-15 09:19:52,896 INFO Training step 476
2021-09-15 09:20:07,091 INFO Training step 478
2021-09-15 09:20:16,643 INFO Training step 480
2021-09-15 09:20:30,487 INFO Training step 482
2021-09-15 09:20:49,461 INFO Training step 484
2021-09-15 09:21:03,237 INFO Training step 486
2021-09-15 09:21:17,411 INFO Training step 488
2021-09-15 09:21:30,273 INFO Training step 490
2021-09-15 09:21:48,302 INFO Training step 492
2021-09-15 09:22:01,055 INFO Training step 494
2021-09-15 09:22:19,403 INFO Training step 496
2021-09-15 09:22:33,307 INFO Training step 498
2021-09-15 09:22:47,279 INFO Training step 500
2021-09-15 09:22:47,281 INFO Loading dataset from data/v1/processed/SimQA.valid.0.pt
2021-09-15 09:22:47,294 INFO number of examples: 555
2021-09-15 09:23:13,115 INFO Validation metrics: Bleu: 0.9557,Correct answers 0.8690, State transitions score: 0.8474
2021-09-15 09:23:26,540 INFO Training step 502
2021-09-15 09:23:36,505 INFO Training step 504
2021-09-15 09:23:50,797 INFO Training step 506
2021-09-15 09:24:00,655 INFO Training step 508
2021-09-15 09:24:19,243 INFO Training step 510
2021-09-15 09:24:38,035 INFO Training step 512
2021-09-15 09:24:47,889 INFO Training step 514
2021-09-15 09:25:02,349 INFO Training step 516
2021-09-15 09:25:21,489 INFO Training step 518
2021-09-15 09:25:39,946 INFO Training step 520
2021-09-15 09:25:57,931 INFO Training step 522
2021-09-15 09:26:16,880 INFO Training step 524
2021-09-15 09:26:30,478 INFO Training step 526
2021-09-15 09:26:48,430 INFO Training step 528
2021-09-15 09:27:06,537 INFO Training step 530
2021-09-15 09:27:25,355 INFO Training step 532
2021-09-15 09:27:39,150 INFO Training step 534
2021-09-15 09:27:53,025 INFO Training step 536
2021-09-15 09:28:06,822 INFO Training step 538
2021-09-15 09:28:24,229 INFO Training step 540
2021-09-15 09:28:42,614 INFO Training step 542
2021-09-15 09:28:59,285 INFO Training step 544
2021-09-15 09:29:14,092 INFO Training step 546
2021-09-15 09:29:28,196 INFO Training step 548
2021-09-15 09:29:41,442 INFO Training step 550
2021-09-15 09:29:56,104 INFO Training step 552
2021-09-15 09:30:13,394 INFO Training step 554
2021-09-15 09:30:18,002 INFO Loading dataset from data/v1/processed/SimQA.train.0.pt
2021-09-15 09:30:18,073 INFO number of examples: 3148
2021-09-15 09:30:31,536 INFO Training step 556
2021-09-15 09:30:49,982 INFO Training step 558
2021-09-15 09:31:03,894 INFO Training step 560
2021-09-15 09:31:17,900 INFO Training step 562
2021-09-15 09:31:36,214 INFO Training step 564
2021-09-15 09:31:49,674 INFO Training step 566
2021-09-15 09:32:02,776 INFO Training step 568
2021-09-15 09:32:16,605 INFO Training step 570
2021-09-15 09:32:35,270 INFO Training step 572
2021-09-15 09:32:49,641 INFO Training step 574
2021-09-15 09:32:59,080 INFO Training step 576
2021-09-15 09:33:17,138 INFO Training step 578
2021-09-15 09:33:35,945 INFO Training step 580
2021-09-15 09:33:50,695 INFO Training step 582
2021-09-15 09:34:04,655 INFO Training step 584
2021-09-15 09:34:23,078 INFO Training step 586
2021-09-15 09:34:41,832 INFO Training step 588
2021-09-15 09:34:59,649 INFO Training step 590
2021-09-15 09:35:14,098 INFO Training step 592
2021-09-15 09:35:28,276 INFO Training step 594
2021-09-15 09:35:45,570 INFO Training step 596
2021-09-15 09:36:03,774 INFO Training step 598
2021-09-15 09:36:17,451 INFO Training step 600
2021-09-15 09:36:17,453 INFO Loading dataset from data/v1/processed/SimQA.valid.0.pt
2021-09-15 09:36:17,465 INFO number of examples: 555
2021-09-15 09:36:43,653 INFO Validation metrics: Bleu: 0.8959,Correct answers 0.8664, State transitions score: 0.8638
2021-09-15 09:36:43,670 INFO Saving checkpoint /home/nitai/SimQA/checkpoints/RL_v1_step_600.pt
