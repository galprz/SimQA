hello from Python 3.7.11 in /home/nitai/miniconda3/envs/SimQA-code/bin/python
running train_mle.py experiments
2021-10-23 20:14:14,135 INFO Running on device=`cuda` (device_id=0)
2021-10-23 20:14:18,203 INFO Start training loop and validate every 100 steps...
2021-10-23 20:14:18,204 INFO Loading dataset from data/v3/processed/SimQA.valid.0.pt
2021-10-23 20:14:18,248 INFO number of examples: 534
2021-10-23 20:14:33,918 INFO Validation metrics: Bleu: 0.9861,Correct answers 0.7907, State transitions score: 0.8141
2021-10-23 20:14:33,919 INFO Loading dataset from data/v3/processed/SimQA.train.0.pt
2021-10-23 20:14:34,254 INFO number of examples: 3029
/home/nitai/miniconda3/envs/SimQA-code/lib/python3.7/site-packages/onmt/translate/beam_search.py:209: UserWarning: An output with one or more elements was resized since it had shape [512], which does not match the required output shape [16, 32].This behavior is deprecated, and in a future PyTorch release outputs will not be resized unless they have zero elements. You can explicitly reuse an out tensor t by resizing it, inplace, to zero elements with t.resize_(0). (Triggered internally at  /pytorch/aten/src/ATen/native/Resize.cpp:23.)
  torch.mul(self.topk_scores, length_penalty, out=self.topk_log_probs)
/home/nitai/miniconda3/envs/SimQA-code/lib/python3.7/site-packages/torch/_tensor.py:575: UserWarning: floor_divide is deprecated, and will be removed in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values.
To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor'). (Triggered internally at  /pytorch/aten/src/ATen/native/BinaryOps.cpp:467.)
  return torch.floor_divide(self, other)
2021-10-23 20:14:54,654 INFO Training step 2
2021-10-23 20:15:11,034 INFO Training step 4
2021-10-23 20:15:31,208 INFO Training step 6
2021-10-23 20:15:48,316 INFO Training step 8
2021-10-23 20:16:07,174 INFO Training step 10
2021-10-23 20:16:28,213 INFO Training step 12
2021-10-23 20:16:49,415 INFO Training step 14
2021-10-23 20:17:10,260 INFO Training step 16
2021-10-23 20:17:22,200 INFO Training step 18
2021-10-23 20:17:39,356 INFO Training step 20
2021-10-23 20:18:00,806 INFO Training step 22
2021-10-23 20:18:21,690 INFO Training step 24
2021-10-23 20:18:42,760 INFO Training step 26
2021-10-23 20:19:02,478 INFO Training step 28
2021-10-23 20:19:23,085 INFO Training step 30
2021-10-23 20:19:45,499 INFO Training step 32
2021-10-23 20:19:58,532 INFO Training step 34
2021-10-23 20:20:19,952 INFO Training step 36
/home/nitai/miniconda3/envs/SimQA-code/lib/python3.7/site-packages/onmt/translate/beam_search.py:209: UserWarning: An output with one or more elements was resized since it had shape [160], which does not match the required output shape [5, 32].This behavior is deprecated, and in a future PyTorch release outputs will not be resized unless they have zero elements. You can explicitly reuse an out tensor t by resizing it, inplace, to zero elements with t.resize_(0). (Triggered internally at  /pytorch/aten/src/ATen/native/Resize.cpp:23.)
  torch.mul(self.topk_scores, length_penalty, out=self.topk_log_probs)
2021-10-23 20:20:39,581 INFO Training step 38
2021-10-23 20:21:00,567 INFO Training step 40
2021-10-23 20:21:20,988 INFO Training step 42
2021-10-23 20:21:41,523 INFO Training step 44
2021-10-23 20:22:03,237 INFO Training step 46
2021-10-23 20:22:24,647 INFO Training step 48
2021-10-23 20:22:45,155 INFO Training step 50
2021-10-23 20:23:06,952 INFO Training step 52
2021-10-23 20:23:26,560 INFO Training step 54
2021-10-23 20:23:47,696 INFO Training step 56
2021-10-23 20:24:11,382 INFO Training step 58
2021-10-23 20:24:32,456 INFO Training step 60
2021-10-23 20:24:49,690 INFO Training step 62
2021-10-23 20:25:11,577 INFO Training step 64
2021-10-23 20:25:26,502 INFO Training step 66
2021-10-23 20:25:29,971 INFO Loading dataset from data/v3/processed/SimQA.train.0.pt
2021-10-23 20:25:30,327 INFO number of examples: 3029
2021-10-23 20:25:48,803 INFO Training step 68
2021-10-23 20:26:03,274 INFO Training step 70
2021-10-23 20:26:25,238 INFO Training step 72
2021-10-23 20:26:46,579 INFO Training step 74
2021-10-23 20:27:04,172 INFO Training step 76
2021-10-23 20:27:24,874 INFO Training step 78
2021-10-23 20:27:41,970 INFO Training step 80
2021-10-23 20:28:03,820 INFO Training step 82
2021-10-23 20:28:20,707 INFO Training step 84
2021-10-23 20:28:40,298 INFO Training step 86
2021-10-23 20:29:24,084 INFO Training step 88
2021-10-23 20:29:39,192 INFO Training step 90
2021-10-23 20:30:00,360 INFO Training step 92
2021-10-23 20:30:21,051 INFO Training step 94
2021-10-23 20:30:41,883 INFO Training step 96
2021-10-23 20:31:02,847 INFO Training step 98
2021-10-23 20:31:23,092 INFO Training step 100
2021-10-23 20:31:23,094 INFO Loading dataset from data/v3/processed/SimQA.valid.0.pt
2021-10-23 20:31:23,138 INFO number of examples: 534
2021-10-23 20:31:38,981 INFO Validation metrics: Bleu: 0.9891,Correct answers 0.7806, State transitions score: 0.8101
2021-10-23 20:31:56,021 INFO Training step 102
2021-10-23 20:32:12,961 INFO Training step 104
2021-10-23 20:32:33,059 INFO Training step 106
2021-10-23 20:32:53,321 INFO Training step 108
2021-10-23 20:33:12,803 INFO Training step 110
2021-10-23 20:33:34,526 INFO Training step 112
2021-10-23 20:33:53,098 INFO Training step 114
2021-10-23 20:34:13,932 INFO Training step 116
2021-10-23 20:34:35,712 INFO Training step 118
2021-10-23 20:34:56,740 INFO Training step 120
2021-10-23 20:35:12,818 INFO Training step 122
2021-10-23 20:35:34,623 INFO Training step 124
2021-10-23 20:35:53,909 INFO Training step 126
2021-10-23 20:36:16,131 INFO Training step 128
2021-10-23 20:36:31,378 INFO Training step 130
2021-10-23 20:36:52,792 INFO Training step 132
2021-10-23 20:37:06,300 INFO Loading dataset from data/v3/processed/SimQA.train.0.pt
2021-10-23 20:37:06,544 INFO number of examples: 3029
2021-10-23 20:37:13,720 INFO Training step 134
2021-10-23 20:37:35,257 INFO Training step 136
2021-10-23 20:37:57,024 INFO Training step 138
2021-10-23 20:38:14,703 INFO Training step 140
2021-10-23 20:38:36,392 INFO Training step 142
2021-10-23 20:38:57,403 INFO Training step 144
2021-10-23 20:39:17,729 INFO Training step 146
2021-10-23 20:39:37,193 INFO Training step 148
2021-10-23 20:39:57,775 INFO Training step 150
2021-10-23 20:40:16,740 INFO Training step 152
2021-10-23 20:40:38,050 INFO Training step 154
2021-10-23 20:41:00,214 INFO Training step 156
2021-10-23 20:41:21,654 INFO Training step 158
2021-10-23 20:41:43,103 INFO Training step 160
2021-10-23 20:42:02,641 INFO Training step 162
2021-10-23 20:42:23,600 INFO Training step 164
2021-10-23 20:42:39,342 INFO Training step 166
2021-10-23 20:43:00,033 INFO Training step 168
2021-10-23 20:43:17,252 INFO Training step 170
2021-10-23 20:43:29,577 INFO Training step 172
2021-10-23 20:43:47,081 INFO Training step 174
2021-10-23 20:44:07,395 INFO Training step 176
2021-10-23 20:44:28,125 INFO Training step 178
2021-10-23 20:44:49,502 INFO Training step 180
2021-10-23 20:45:11,469 INFO Training step 182
2021-10-23 20:45:32,400 INFO Training step 184
2021-10-23 20:45:53,426 INFO Training step 186
2021-10-23 20:46:15,257 INFO Training step 188
2021-10-23 20:46:37,148 INFO Training step 190
2021-10-23 20:46:56,621 INFO Training step 192
2021-10-23 20:47:15,610 INFO Training step 194
2021-10-23 20:47:33,880 INFO Training step 196
2021-10-23 20:47:51,197 INFO Training step 198
2021-10-23 20:48:04,914 INFO Loading dataset from data/v3/processed/SimQA.train.0.pt
2021-10-23 20:48:05,156 INFO number of examples: 3029
2021-10-23 20:48:08,797 INFO Training step 200
2021-10-23 20:48:08,799 INFO Loading dataset from data/v3/processed/SimQA.valid.0.pt
2021-10-23 20:48:08,843 INFO number of examples: 534
2021-10-23 20:48:24,711 INFO Validation metrics: Bleu: 0.9900,Correct answers 0.8097, State transitions score: 0.8337
2021-10-23 20:48:41,630 INFO Training step 202
2021-10-23 20:49:01,663 INFO Training step 204
2021-10-23 20:49:23,473 INFO Training step 206
2021-10-23 20:49:41,239 INFO Training step 208
2021-10-23 20:50:00,627 INFO Training step 210
2021-10-23 20:50:15,681 INFO Training step 212
2021-10-23 20:50:36,710 INFO Training step 214
2021-10-23 20:50:58,633 INFO Training step 216
2021-10-23 20:51:20,347 INFO Training step 218
2021-10-23 20:51:42,798 INFO Training step 220
2021-10-23 20:52:00,815 INFO Training step 222
2021-10-23 20:52:21,986 INFO Training step 224
2021-10-23 20:52:43,588 INFO Training step 226
2021-10-23 20:53:03,406 INFO Training step 228
2021-10-23 20:53:19,077 INFO Training step 230
2021-10-23 20:53:39,901 INFO Training step 232
2021-10-23 20:53:59,619 INFO Training step 234
2021-10-23 20:54:20,812 INFO Training step 236
2021-10-23 20:54:38,206 INFO Training step 238
2021-10-23 20:55:00,157 INFO Training step 240
2021-10-23 20:55:21,753 INFO Training step 242
2021-10-23 20:55:43,317 INFO Training step 244
2021-10-23 20:56:00,472 INFO Training step 246
2021-10-23 20:56:22,069 INFO Training step 248
2021-10-23 20:56:43,890 INFO Training step 250
2021-10-23 20:57:01,595 INFO Training step 252
2021-10-23 20:57:23,212 INFO Training step 254
2021-10-23 20:57:40,014 INFO Training step 256
2021-10-23 20:58:00,306 INFO Training step 258
2021-10-23 20:58:19,086 INFO Training step 260
2021-10-23 20:58:39,109 INFO Training step 262
2021-10-23 20:58:55,421 INFO Training step 264
2021-10-23 20:59:15,742 INFO Training step 266
2021-10-23 20:59:19,114 INFO Loading dataset from data/v3/processed/SimQA.train.0.pt
2021-10-23 20:59:19,463 INFO number of examples: 3029
2021-10-23 20:59:36,834 INFO Training step 268
2021-10-23 20:59:52,289 INFO Training step 270
2021-10-23 21:00:13,621 INFO Training step 272
2021-10-23 21:00:35,037 INFO Training step 274
2021-10-23 21:00:56,124 INFO Training step 276
2021-10-23 21:01:12,678 INFO Training step 278
2021-10-23 21:01:25,206 INFO Training step 280
2021-10-23 21:01:41,637 INFO Training step 282
2021-10-23 21:02:01,984 INFO Training step 284
2021-10-23 21:02:22,412 INFO Training step 286
2021-10-23 21:02:45,301 INFO Training step 288
2021-10-23 21:03:04,770 INFO Training step 290
2021-10-23 21:03:25,032 INFO Training step 292
2021-10-23 21:03:44,561 INFO Training step 294
2021-10-23 21:04:05,467 INFO Training step 296
2021-10-23 21:04:22,507 INFO Training step 298
2021-10-23 21:04:40,271 INFO Training step 300
2021-10-23 21:04:40,273 INFO Loading dataset from data/v3/processed/SimQA.valid.0.pt
2021-10-23 21:04:40,318 INFO number of examples: 534
2021-10-23 21:04:56,199 INFO Validation metrics: Bleu: 0.9885,Correct answers 0.7858, State transitions score: 0.8151
2021-10-23 21:05:17,109 INFO Training step 302
2021-10-23 21:05:38,656 INFO Training step 304
2021-10-23 21:06:01,164 INFO Training step 306
2021-10-23 21:06:22,520 INFO Training step 308
2021-10-23 21:06:43,676 INFO Training step 310
2021-10-23 21:07:05,139 INFO Training step 312
2021-10-23 21:07:25,861 INFO Training step 314
2021-10-23 21:07:50,260 INFO Training step 316
2021-10-23 21:08:11,281 INFO Training step 318
2021-10-23 21:08:30,658 INFO Training step 320
2021-10-23 21:08:52,883 INFO Training step 322
2021-10-23 21:09:10,022 INFO Training step 324
2021-10-23 21:09:30,559 INFO Training step 326
2021-10-23 21:09:51,447 INFO Training step 328
2021-10-23 21:10:12,638 INFO Training step 330
2021-10-23 21:10:32,723 INFO Training step 332
2021-10-23 21:10:32,724 INFO Loading dataset from data/v3/processed/SimQA.train.0.pt
2021-10-23 21:10:32,963 INFO number of examples: 3029
2021-10-23 21:10:54,080 INFO Training step 334
2021-10-23 21:11:10,384 INFO Training step 336
2021-10-23 21:11:31,814 INFO Training step 338
2021-10-23 21:11:50,714 INFO Training step 340
2021-10-23 21:12:11,831 INFO Training step 342
2021-10-23 21:12:33,228 INFO Training step 344
2021-10-23 21:12:50,048 INFO Training step 346
2021-10-23 21:13:09,973 INFO Training step 348
2021-10-23 21:13:30,847 INFO Training step 350
2021-10-23 21:13:51,390 INFO Training step 352
2021-10-23 21:14:11,904 INFO Training step 354
2021-10-23 21:14:32,385 INFO Training step 356
2021-10-23 21:14:53,351 INFO Training step 358
2021-10-23 21:15:13,321 INFO Training step 360
2021-10-23 21:15:34,397 INFO Training step 362
2021-10-23 21:15:56,528 INFO Training step 364
2021-10-23 21:16:14,024 INFO Training step 366
2021-10-23 21:16:35,960 INFO Training step 368
2021-10-23 21:16:56,759 INFO Training step 370
2021-10-23 21:17:18,569 INFO Training step 372
2021-10-23 21:17:39,399 INFO Training step 374
2021-10-23 21:18:00,595 INFO Training step 376
2021-10-23 21:18:20,998 INFO Training step 378
2021-10-23 21:18:42,483 INFO Training step 380
2021-10-23 21:19:02,585 INFO Training step 382
2021-10-23 21:19:22,680 INFO Training step 384
2021-10-23 21:19:41,726 INFO Training step 386
2021-10-23 21:20:02,590 INFO Training step 388
2021-10-23 21:20:22,528 INFO Training step 390
2021-10-23 21:20:43,482 INFO Training step 392
2021-10-23 21:21:22,496 INFO Training step 394
2021-10-23 21:21:43,200 INFO Training step 396
2021-10-23 21:21:46,480 INFO Loading dataset from data/v3/processed/SimQA.train.0.pt
2021-10-23 21:21:46,720 INFO number of examples: 3029
2021-10-23 21:22:00,387 INFO Training step 398
2021-10-23 21:22:16,486 INFO Training step 400
2021-10-23 21:22:16,487 INFO Loading dataset from data/v3/processed/SimQA.valid.0.pt
2021-10-23 21:22:16,530 INFO number of examples: 534
2021-10-23 21:22:32,367 INFO Validation metrics: Bleu: 0.9878,Correct answers 0.7876, State transitions score: 0.8133
2021-10-23 21:22:50,902 INFO Training step 402
2021-10-23 21:23:12,314 INFO Training step 404
2021-10-23 21:23:32,699 INFO Training step 406
2021-10-23 21:23:54,686 INFO Training step 408
2021-10-23 21:24:18,005 INFO Training step 410
2021-10-23 21:24:39,030 INFO Training step 412
2021-10-23 21:25:00,166 INFO Training step 414
2021-10-23 21:25:19,995 INFO Training step 416
2021-10-23 21:25:39,684 INFO Training step 418
2021-10-23 21:26:00,122 INFO Training step 420
2021-10-23 21:26:22,702 INFO Training step 422
2021-10-23 21:26:43,869 INFO Training step 424
2021-10-23 21:27:00,154 INFO Training step 426
2021-10-23 21:27:18,192 INFO Training step 428
2021-10-23 21:27:39,788 INFO Training step 430
2021-10-23 21:28:00,241 INFO Training step 432
2021-10-23 21:28:20,350 INFO Training step 434
2021-10-23 21:28:37,597 INFO Training step 436
2021-10-23 21:28:54,668 INFO Training step 438
2021-10-23 21:29:15,430 INFO Training step 440
2021-10-23 21:29:33,246 INFO Training step 442
2021-10-23 21:29:54,943 INFO Training step 444
2021-10-23 21:30:15,811 INFO Training step 446
2021-10-23 21:30:37,027 INFO Training step 448
2021-10-23 21:30:59,053 INFO Training step 450
2021-10-23 21:31:19,572 INFO Training step 452
2021-10-23 21:31:39,439 INFO Training step 454
2021-10-23 21:31:59,423 INFO Training step 456
2021-10-23 21:32:20,376 INFO Training step 458
2021-10-23 21:32:39,029 INFO Training step 460
2021-10-23 21:32:59,144 INFO Training step 462
2021-10-23 21:32:59,145 INFO Loading dataset from data/v3/processed/SimQA.train.0.pt
2021-10-23 21:32:59,502 INFO number of examples: 3029
2021-10-23 21:33:17,193 INFO Training step 464
2021-10-23 21:33:38,807 INFO Training step 466
2021-10-23 21:33:55,418 INFO Training step 468
2021-10-23 21:34:11,594 INFO Training step 470
2021-10-23 21:34:29,213 INFO Training step 472
2021-10-23 21:34:50,395 INFO Training step 474
2021-10-23 21:35:12,260 INFO Training step 476
2021-10-23 21:35:34,828 INFO Training step 478
2021-10-23 21:35:53,695 INFO Training step 480
2021-10-23 21:36:15,596 INFO Training step 482
2021-10-23 21:36:36,667 INFO Training step 484
2021-10-23 21:36:51,978 INFO Training step 486
2021-10-23 21:37:13,050 INFO Training step 488
2021-10-23 21:37:33,843 INFO Training step 490
2021-10-23 21:37:56,341 INFO Training step 492
2021-10-23 21:38:15,601 INFO Training step 494
2021-10-23 21:38:36,642 INFO Training step 496
2021-10-23 21:38:58,997 INFO Training step 498
2021-10-23 21:39:20,527 INFO Training step 500
2021-10-23 21:39:20,529 INFO Loading dataset from data/v3/processed/SimQA.valid.0.pt
2021-10-23 21:39:20,576 INFO number of examples: 534
2021-10-23 21:39:36,433 INFO Validation metrics: Bleu: 0.9875,Correct answers 0.7756, State transitions score: 0.8008
2021-10-23 21:39:57,670 INFO Training step 502
2021-10-23 21:40:18,532 INFO Training step 504
2021-10-23 21:40:39,675 INFO Training step 506
2021-10-23 21:40:59,579 INFO Training step 508
2021-10-23 21:41:20,333 INFO Training step 510
2021-10-23 21:41:39,457 INFO Training step 512
2021-10-23 21:42:00,286 INFO Training step 514
2021-10-23 21:42:17,454 INFO Training step 516
2021-10-23 21:42:37,333 INFO Training step 518
2021-10-23 21:42:56,895 INFO Training step 520
2021-10-23 21:43:18,282 INFO Training step 522
2021-10-23 21:43:38,558 INFO Training step 524
2021-10-23 21:43:59,162 INFO Training step 526
2021-10-23 21:44:13,480 INFO Loading dataset from data/v3/processed/SimQA.train.0.pt
2021-10-23 21:44:13,724 INFO number of examples: 3029
2021-10-23 21:44:20,798 INFO Training step 528
2021-10-23 21:44:37,800 INFO Training step 530
2021-10-23 21:44:58,304 INFO Training step 532
2021-10-23 21:45:14,720 INFO Training step 534
2021-10-23 21:45:31,830 INFO Training step 536
2021-10-23 21:45:51,998 INFO Training step 538
2021-10-23 21:46:11,850 INFO Training step 540
2021-10-23 21:46:30,790 INFO Training step 542
2021-10-23 21:46:51,806 INFO Training step 544
2021-10-23 21:47:08,749 INFO Training step 546
2021-10-23 21:47:32,224 INFO Training step 548
2021-10-23 21:47:49,499 INFO Training step 550
2021-10-23 21:48:11,895 INFO Training step 552
2021-10-23 21:48:33,708 INFO Training step 554
2021-10-23 21:48:50,444 INFO Training step 556
2021-10-23 21:49:11,611 INFO Training step 558
2021-10-23 21:49:32,643 INFO Training step 560
2021-10-23 21:49:53,901 INFO Training step 562
2021-10-23 21:50:16,422 INFO Training step 564
2021-10-23 21:50:37,158 INFO Training step 566
2021-10-23 21:50:58,458 INFO Training step 568
2021-10-23 21:51:15,903 INFO Training step 570
2021-10-23 21:51:36,548 INFO Training step 572
2021-10-23 21:51:53,509 INFO Training step 574
2021-10-23 21:52:10,500 INFO Training step 576
2021-10-23 21:52:30,755 INFO Training step 578
2021-10-23 21:52:52,705 INFO Training step 580
2021-10-23 21:53:14,248 INFO Training step 582
2021-10-23 21:53:35,030 INFO Training step 584
2021-10-23 21:53:51,927 INFO Training step 586
2021-10-23 21:54:07,762 INFO Training step 588
2021-10-23 21:54:29,215 INFO Training step 590
2021-10-23 21:54:49,138 INFO Training step 592
2021-10-23 21:55:08,862 INFO Training step 594
2021-10-23 21:55:12,015 INFO Loading dataset from data/v3/processed/SimQA.train.0.pt
2021-10-23 21:55:12,260 INFO number of examples: 3029
2021-10-23 21:55:29,352 INFO Training step 596
2021-10-23 21:55:46,849 INFO Training step 598
2021-10-23 21:56:06,805 INFO Training step 600
2021-10-23 21:56:06,807 INFO Loading dataset from data/v3/processed/SimQA.valid.0.pt
2021-10-23 21:56:06,851 INFO number of examples: 534
2021-10-23 21:56:22,748 INFO Validation metrics: Bleu: 0.9884,Correct answers 0.7771, State transitions score: 0.8092
2021-10-23 21:56:22,766 INFO Saving checkpoint /home/nitai/SimQA/checkpoints/RL/v3/baseline_step_600.pt
